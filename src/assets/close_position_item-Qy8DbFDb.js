import{B as f,D as y,G as k,H as A,z as P,E}from"./zixuan_list.vue_vue_type_style_index_0_lang-Bztu2ySh.js";/* empty css                  *//* empty css                 *//* empty css                  */import{a as $,E as j}from"./el-option-DgYD06Jd.js";/* empty css                  */import{d as K,u as O,a as G,I as M,w as z,c as n,j as u,k as s,v as d,l as t,m as i,p as r,J as g,a1 as x,e as b,s as c,a0 as m,E as R}from"./main-BeSCBoN1.js";import{s as H}from"./SendData-B_I2FNqn.js";import{E as T}from"./index-CSTuB7SG.js";import"./index-DyY66E7G.js";const J={class:"container"},q={class:"container"},Q={class:"container"},W={class:"container"},X={key:0,class:"container"},Y={key:1,class:"container"},Z={key:2,class:"container"},ee={key:3,class:"container"},oe={key:4,class:"container"},le={key:5,class:"container"},te={key:6,class:"container"},ie={key:7,class:"container"},se={key:8,class:"container"},ae={key:9,class:"container"},ne={key:10,class:"container"},re={key:11},de={class:"container"},ue={key:0,class:"container"},pe={key:1,class:"container"},_e={key:2,class:"container"},ce={key:3,class:"container"},me={key:4,class:"container"},ye={key:5},fe={class:"container"},Ve={class:"container"},ve={class:"container"},be={key:12},we={class:"container"},ke={class:"container"},ge={key:13},xe={class:"container"},Ue={key:0},he={class:"container"},Fe={class:"container"},Ee={class:"center-container"},$e=K({__name:"close_position_item",props:{info:{},status:{default:"defaultStatus"}},setup(B){const _=O(),a=G(),U=B,e=M({});function S(){if(!U.info){console.warn("props.info is undefined or null, initializing with default empty swap_traderParams");return}console.log("Initializing swap_trade_info with props:",U.info);try{Object.assign(e,U.info),e.action=U.info.action}catch(p){console.error("Failed to initialize swap_trade_info:",p),T({title:"初始化失败",message:"执行账号信息初始化时出现错误，请检查输入数据。",type:"error"})}}S();function C(p){a.swap_trade_info.times=e.times,a.swap_trade_info.prices=e.prices;const V=new Map([["entry_price","#00FF00"],["loss_price","#FF0000"],["end_price","#D9D919"],["win_price","#00FF00"],["active_price","#00FF00"],["monitor_loss_price","#FF0000"],["safe_price","#D9D919"],["monitor_win_price","#00FF00"],["straightLine","#00FF00"]]).get(p);_==null||_.del_price_line([p]),_==null||_.createTag(p,V)}async function I(p){return await E.confirm(p,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}function D(p){E.alert(p)}async function h(p){const l=localStorage.getItem("bot_ip"),V=localStorage.getItem("bot_key");if(!l||!V){console.warn("bot_ip 或 bot_key 未找到");return}const v=`http://${l}/takeover_order`,w={tradtype:"swap",symbol:e.symbol,action:"close_position",action_info:{item:e,action:p,symbol:e.symbol,side:e.side},key:V,account:e.api_key,side:e.side};try{const o=await H(w,v);o.status==="sucess"?(T({title:"执行成功",message:o.msg,type:"success"}),a.reset_swap_info(),_.del_all_price_tool()):await I(o.msg)}catch(o){console.error("请求错误:",o),D("请求出现错误，请重试")}}function F(){const p=[];for(let l=1;l<=600;l++)p.push(l);return p}async function L(){return new Promise(p=>{const l=()=>{_.loadingkline?(console.log("loadingkline is true"),setTimeout(l,100)):p()};l()})}async function N(){if(_.chart){if(_.symbol.ticker!==e.symbol){const p=_.all_symbols.find(l=>l.ticker===e.symbol);if(p){const l=_.makePeriod(e.price_period);Object.assign(_.period,l),_.set_symbol(p)}}else _.period.timeframe!==e.price_period&&_.set_period(_.makePeriod(e.price_period));if(e.action.includes("trend_line")){await L(),_==null||_.del_price_line(["parallelStraightLine_self"]);const p=e.times.split(","),V=e.prices.split(",").map((v,w)=>{const o=Number(v);return{timestamp:Number(p[w])||0,value:o||0}});_==null||_.createTag("straightLine","#00FF00",!0,V)}}}return z(()=>e.signal_period,p=>{p.length>2&&(e.signal_period=p.slice(-2))}),z(()=>a.swap_trade_info.prices,p=>{e.prices=a.swap_trade_info.prices,e.times=a.swap_trade_info.times}),(p,l)=>{const V=$,v=j,w=P;return n(),u(g,null,[s("div",J,[s("p",{style:d({color:t(a).color})},"执行账号:",4),i(v,{modelValue:e.api_key,"onUpdate:modelValue":l[0]||(l[0]=o=>e.api_key=o),placeholder:"选择执行的动作",teleported:!1,style:{width:"200px"},disabled:""},{default:r(()=>[(n(!0),u(g,null,x(t(a).bot_data.api_list,o=>(n(),b(V,{key:o.account_name,label:o.account_name,value:o.api_key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",q,[s("p",{style:d({color:t(a).color})},"执行币种:",4),i(t(f),{style:{width:"200px"},modelValue:e.symbol,"onUpdate:modelValue":l[1]||(l[1]=o=>e.symbol=o),disabled:""},null,8,["modelValue"])]),s("div",Q,[s("p",{style:d({color:t(a).color})},"行情周期:",4),i(v,{modelValue:e.price_period,"onUpdate:modelValue":l[2]||(l[2]=o=>e.price_period=o),placeholder:"选择监控项目",teleported:!1,filterable:"",style:{width:"200px"}},{default:r(()=>[(n(!0),u(g,null,x(t(_).AllPeriods,o=>(n(),b(V,{key:o.timeframe,label:o.timeframe,value:o.timeframe},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",W,[s("p",{style:d({color:t(a).color})},"离场动作:",4),i(v,{modelValue:e.action,"onUpdate:modelValue":l[3]||(l[3]=o=>e.action=o),placeholder:"选择执行的动作",teleported:!1,style:{width:"200px"},disabled:""},{default:r(()=>[(n(!0),u(g,null,x(t(a).out_action_list,o=>(n(),b(V,{key:o.action,label:o.action,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),e.action==="close_position_by_ema"||e.action==="close_position_by_trend_line"?(n(),u("div",X,[s("p",{style:d({color:t(a).color})},"离场比例:",4),i(t(f),{modelValue:e.ratio,"onUpdate:modelValue":l[4]||(l[4]=o=>e.ratio=o),placement:"left",style:{width:"180px"},step:.1,min:1,max:100},null,8,["modelValue"]),s("p",{style:d({color:t(a).color})},"%",4)])):c("",!0),e.action==="close_position_by_profit"?(n(),u("div",Y,[s("p",{style:d({color:t(a).color})},"持仓盈利:",4),i(t(f),{modelValue:e.ratio,"onUpdate:modelValue":l[5]||(l[5]=o=>e.ratio=o),step:.5,min:.1,style:{width:"180px"}},null,8,["modelValue"]),s("p",{style:d({color:t(a).color,width:"20px",textAlign:"center"})},"%",4)])):c("",!0),e.action=="close_position_by_ratio"||e.action=="close_position_by_move_stop"?(n(),u("div",Z,[s("p",{style:d({color:t(a).color})},"执行模式:",4),i(t(k),{size:"default",modelValue:e.order_type,"onUpdate:modelValue":l[6]||(l[6]=o=>e.order_type=o)},{default:r(()=>[i(t(y),{value:"market"},{default:r(()=>[m("市价执行")]),_:1}),i(t(y),{value:"limit"},{default:r(()=>[m("限价执行")]),_:1})]),_:1},8,["modelValue"])])):c("",!0),e.action=="close_position_by_ratio"||e.action==="close_position_by_mix"?(n(),u("div",ee,[s("p",{style:d({color:t(a).color})},"分段模式:",4),i(t(k),{size:"default",modelValue:e.action_data,"onUpdate:modelValue":l[7]||(l[7]=o=>e.action_data=o)},{default:r(()=>[i(t(y),{value:""},{default:r(()=>[m("不变")]),_:1}),i(t(y),{value:"move_to_avg"},{default:r(()=>[m("保本")]),_:1}),i(t(y),{value:"step"},{default:r(()=>[m("递进")]),_:1})]),_:1},8,["modelValue"])])):c("",!0),e.action==="close_position_by_mix"||e.action==="close_position_by_ratio"?(n(),u("div",oe,[s("p",{style:d({color:t(a).color})},"离场比例:",4),i(t(f),{modelValue:e.ratio,"onUpdate:modelValue":l[8]||(l[8]=o=>e.ratio=o),placement:"left",style:{width:"180px"},step:.1,min:1,max:100},null,8,["modelValue"]),s("p",{style:d({color:t(a).color})},"%",4)])):c("",!0),e.action==="close_position_by_mix"?(n(),u("div",le,[s("p",{style:d({color:t(a).color})},"加仓逻辑:",4),i(t(k),{size:"default",modelValue:e.mix_type,"onUpdate:modelValue":l[9]||(l[9]=o=>e.mix_type=o)},{default:r(()=>[i(t(y),{value:"average"},{default:r(()=>[m("一倍")]),_:1}),i(t(y),{value:"double"},{default:r(()=>[m("两倍")]),_:1}),i(t(y),{value:"three"},{default:r(()=>[m("三倍")]),_:1})]),_:1},8,["modelValue"])])):c("",!0),e.action==="close_position_by_mix"?(n(),u("div",te,[s("p",{style:d({color:t(a).color})},"加仓次数:",4),i(t(f),{modelValue:e.order_num,"onUpdate:modelValue":l[10]||(l[10]=o=>e.order_num=o),placement:"left",style:{width:"200px"},step:1,min:1,max:15},null,8,["modelValue"])])):c("",!0),e.order_type==="limit"&&(e.action==="close_position_by_ratio"||e.action==="close_position_by_move_stop")||e.action==="close_position_by_mix"?(n(),u("div",ie,[s("p",{style:d({color:t(a).color})},"执行价格:",4),e.action!=="close_position_by_move_stop"?(n(),b(t(f),{key:0,modelValue:e.price,"onUpdate:modelValue":l[11]||(l[11]=o=>e.price=o),placeholder:"",style:{width:"200px"}},null,8,["modelValue"])):c("",!0),e.action==="close_position_by_move_stop"?(n(),b(t(f),{key:1,modelValue:e.win_price,"onUpdate:modelValue":l[12]||(l[12]=o=>e.win_price=o),placeholder:"",style:{width:"200px"}},null,8,["modelValue"])):c("",!0)])):c("",!0),e.action==="close_position_by_move_stop"||e.action==="close_position_by_mix"?(n(),u("div",se,[s("p",{style:d({color:t(a).color})},"结束价格:",4),i(t(f),{modelValue:e.end_price,"onUpdate:modelValue":l[13]||(l[13]=o=>e.end_price=o),style:{width:"200px"}},null,8,["modelValue"])])):c("",!0),e.action==="close_position_by_ratio"?(n(),u("div",ae,[s("p",{style:d({color:t(a).color})},"止盈价格:",4),i(t(f),{modelValue:e.win_price,"onUpdate:modelValue":l[14]||(l[14]=o=>e.win_price=o),style:{width:"200px"}},null,8,["modelValue"])])):c("",!0),e.action==="close_position_by_ratio"||e.action==="close_position_by_move_stop"?(n(),u("div",ne,[s("p",{style:d({color:t(a).color})},"止损价格:",4),i(t(f),{modelValue:e.loss_price,"onUpdate:modelValue":l[15]||(l[15]=o=>e.loss_price=o),style:{width:"200px"}},null,8,["modelValue"])])):c("",!0),e.action==="close_position_by_ema"||e.action==="close_position_by_trend_line"?(n(),u("div",re,[s("div",de,[s("p",{style:d({color:t(a).color})},"修改项目:",4),i(t(k),{size:"small",modelValue:e.action_data,"onUpdate:modelValue":l[16]||(l[16]=o=>e.action_data=o)},{default:r(()=>[i(t(y),{value:"win"},{default:r(()=>[m("修改止盈")]),_:1}),i(t(y),{value:"loss"},{default:r(()=>[m("修改止损")]),_:1}),i(t(y),{value:"break"},{default:r(()=>[m("突破离场")]),_:1})]),_:1},8,["modelValue"])]),e.action==="close_position_by_trend_line"?(n(),u("div",ue,[s("p",{style:d({color:t(a).color})},"画趋势线:",4),i(t(f),{modelValue:e.times,"onUpdate:modelValue":l[18]||(l[18]=o=>e.times=o),placeholder:"请画一条趋势线",style:{width:"200px"},disabled:""},R({_:2},[t(_).draw==="chart"?{name:"append",fn:r(()=>[i(w,{icon:t(A),onClick:l[17]||(l[17]=o=>C("straightLine"))},null,8,["icon"])]),key:"0"}:void 0]),1032,["modelValue"])])):c("",!0),e.action==="close_position_by_ema"?(n(),u("div",pe,[s("p",{style:d({color:t(a).color})},"执行均线:",4),i(v,{modelValue:e.signal_period,"onUpdate:modelValue":l[19]||(l[19]=o=>e.signal_period=o),placeholder:"选择执行的动作",teleported:!1,style:{width:"200px"},filterable:""},{default:r(()=>[(n(!0),u(g,null,x(F(),o=>(n(),b(V,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])):c("",!0),e.action_data==="loss"?(n(),u("div",_e,[s("p",{style:d({color:t(a).color})},"执行模式:",4),i(t(k),{size:"default",modelValue:e.order_type,"onUpdate:modelValue":l[20]||(l[20]=o=>e.order_type=o)},{default:r(()=>[i(t(y),{value:"normal"},{default:r(()=>[m("普通止盈")]),_:1}),i(t(y),{value:"mix_out"},{default:r(()=>[m("分段止盈")]),_:1})]),_:1},8,["modelValue"])])):c("",!0),e.action_data==="loss"?(n(),u("div",ce,[s("p",{style:d({color:t(a).color})},"止盈价格:",4),i(t(f),{modelValue:e.win_price,"onUpdate:modelValue":l[21]||(l[21]=o=>e.win_price=o),style:{width:"200px"}},null,8,["modelValue"])])):c("",!0),e.action_data==="win"?(n(),u("div",me,[s("p",{style:d({color:t(a).color})},"止损价格:",4),i(t(f),{modelValue:e.loss_price,"onUpdate:modelValue":l[22]||(l[22]=o=>e.loss_price=o),style:{width:"200px"}},null,8,["modelValue"])])):c("",!0),e.order_type==="mix_out"?(n(),u("div",ye,[s("div",fe,[s("p",{style:d({color:t(a).color})},"结束价格:",4),i(t(f),{modelValue:e.end_price,"onUpdate:modelValue":l[23]||(l[23]=o=>e.end_price=o),style:{width:"200px"}},null,8,["modelValue"])]),s("div",Ve,[s("p",{style:d({color:t(a).color})},"离场次数:",4),i(t(f),{modelValue:e.order_num,"onUpdate:modelValue":l[24]||(l[24]=o=>e.order_num=o),placement:"left",style:{width:"200px"},step:1,min:1,max:15},null,8,["modelValue"])]),s("div",ve,[s("p",{style:d({color:t(a).color})},"离场模式:",4),i(t(k),{size:"default",modelValue:t(a).swap_signal_info.mix_type,"onUpdate:modelValue":l[25]||(l[25]=o=>t(a).swap_signal_info.mix_type=o)},{default:r(()=>[i(t(y),{value:"average"},{default:r(()=>[m("一倍")]),_:1}),i(t(y),{value:"double"},{default:r(()=>[m("两倍")]),_:1}),i(t(y),{value:"three"},{default:r(()=>[m("三倍")]),_:1})]),_:1},8,["modelValue"])])])):c("",!0)])):c("",!0),e.action==="close_position_by_ema_cross"?(n(),u("div",be,[s("div",we,[s("p",{style:d({color:t(a).color})},"执行均线:",4),i(v,{modelValue:e.signal_period,"onUpdate:modelValue":l[26]||(l[26]=o=>e.signal_period=o),placeholder:"选择执行的动作",teleported:!1,style:{width:"200px"},multiple:""},{default:r(()=>[(n(!0),u(g,null,x(F(),o=>(n(),b(V,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",ke,[s("p",{style:d({color:t(a).color})},"均线动作:",4),i(v,{modelValue:e.action_data,"onUpdate:modelValue":l[27]||(l[27]=o=>e.action_data=o),placeholder:"选择执行的动作",teleported:!1,style:{width:"200px"},multiple:""},{default:r(()=>[(n(!0),u(g,null,x(t(a).ema_cross_out_list,o=>(n(),b(V,{key:o.action,label:o.action,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])):c("",!0),e.action==="close_position_by_ema_cross"||e.action==="close_position_by_ema"||e.action==="close_position_by_trend_line"?(n(),u("div",ge,[s("div",xe,[s("p",{style:d({color:t(a).color})},"对向盈损:",4),i(t(k),{size:"default",modelValue:e.reset_win_loss,"onUpdate:modelValue":l[28]||(l[28]=o=>e.reset_win_loss=o)},{default:r(()=>[i(t(y),{value:"yes"},{default:r(()=>[m("启用设置")]),_:1}),i(t(y),{value:"no"},{default:r(()=>[m("禁用设置")]),_:1})]),_:1},8,["modelValue"])]),e.reset_win_loss==="yes"?(n(),u("div",Ue,[s("div",he,[s("p",{style:d({color:t(a).color})},"止盈比例:",4),i(t(f),{modelValue:e.win_present,"onUpdate:modelValue":l[29]||(l[29]=o=>e.win_present=o),style:{width:"180px"}},null,8,["modelValue"]),s("p",{style:d({color:t(a).color})},"%",4)]),s("div",Fe,[s("p",{style:d({color:t(a).color})},"止损比例:",4),i(t(f),{modelValue:e.loss_present,"onUpdate:modelValue":l[30]||(l[30]=o=>e.loss_present=o),style:{width:"180px"}},null,8,["modelValue"]),s("p",{style:d({color:t(a).color})},"%",4)])])):c("",!0)])):c("",!0),s("div",Ee,[i(w,{type:"primary",onClick:l[31]||(l[31]=o=>N())},{default:r(()=>[m("查看计划")]),_:1}),i(w,{type:"warning",onClick:l[32]||(l[32]=o=>h("del"))},{default:r(()=>[m("删除计划")]),_:1}),e.action==="close_position_by_ema_cross"||e.action==="close_position_by_ema"||e.action==="close_position_by_trend_line"?(n(),b(w,{key:0,type:"primary",onClick:l[33]||(l[33]=o=>h("edit"))},{default:r(()=>[m("修改计划")]),_:1})):c("",!0)])],64)}}});export{$e as default};
