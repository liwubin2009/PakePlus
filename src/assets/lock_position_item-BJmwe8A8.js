import{B as w,D as V,G as x,H as L,z as N,E}from"./zixuan_list.vue_vue_type_style_index_0_lang-Bztu2ySh.js";/* empty css                  *//* empty css                 *//* empty css                  */import{a as P,E as $}from"./el-option-DgYD06Jd.js";/* empty css                  */import{d as A,u as j,a as K,I as O,w as G,c as d,j as p,k as s,v as u,l,m as a,p as c,J as g,a1 as F,e as b,a0 as f,s as m,E as M}from"./main-BeSCBoN1.js";import{s as R}from"./SendData-B_I2FNqn.js";import{E as U}from"./index-CSTuB7SG.js";import"./index-DyY66E7G.js";const H={class:"container"},J={class:"container"},q={class:"container"},Q={class:"container"},W={key:0,class:"container"},X={key:1,class:"container"},Y={key:2,class:"container"},Z={key:3,class:"container"},ee={key:4,class:"container"},oe={key:5,class:"container"},te={key:6,class:"container"},le={key:7,class:"container"},ie={key:0,class:"container"},ae={key:1,class:"container"},re={class:"center-container"},we=A({__name:"lock_position_item",props:{info:{},status:{default:"defaultStatus"}},setup(T){const i=j(),r=K(),v=T,e=O({});function B(){if(!v.info){console.warn("props.info is undefined or null, initializing with default empty swap_traderParams");return}console.log("Initializing swap_trade_info with props:",v.info);try{Object.assign(e,v.info),e.action=v.info.action}catch(n){console.error("Failed to initialize swap_trade_info:",n),U({title:"初始化失败",message:"执行账号信息初始化时出现错误，请检查输入数据。",type:"error"})}}B();async function S(n){return await E.confirm(n,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}function z(n){E.alert(n)}async function h(n){const t=localStorage.getItem("bot_ip"),_=localStorage.getItem("bot_key");if(!t||!_){console.warn("bot_ip 或 bot_key 未找到");return}const k=`http://${t}/takeover_order`,y={tradtype:"swap",symbol:e.symbol,action:"lock_position",action_info:{item:e,action:n,symbol:e.symbol,side:e.side},key:_,account:e.api_key,side:e.side};try{const o=await R(y,k);o.status==="sucess"?(U({title:"执行成功",message:o.msg,type:"success"}),r.reset_swap_info(),i.del_all_price_tool()):await S(o.msg)}catch(o){console.error("请求错误:",o),z("请求出现错误，请重试")}}G(()=>r.swap_trade_info.prices,n=>{e.prices=r.swap_trade_info.prices,e.times=r.swap_trade_info.times});function C(n){r.swap_trade_info.times=e.times,r.swap_trade_info.prices=e.prices;const _=new Map([["entry_price","#00FF00"],["loss_price","#FF0000"],["end_price","#D9D919"],["win_price","#00FF00"],["active_price","#00FF00"],["monitor_loss_price","#FF0000"],["safe_price","#D9D919"],["monitor_win_price","#00FF00"],["straightLine","#00FF00"]]).get(n);i==null||i.del_price_line([n]),i==null||i.createTag(n,_)}async function D(){return new Promise(n=>{const t=()=>{i.loadingkline?(console.log("loadingkline is true"),setTimeout(t,100)):n()};t()})}async function I(){if(i.chart){if(i.symbol.ticker!==e.symbol){const n=i.all_symbols.find(t=>t.ticker===e.symbol);if(n){const t=i.makePeriod(e.price_period);Object.assign(i.period,t),i.set_symbol(n)}}else i.period.timeframe!==e.price_period&&i.set_period(i.makePeriod(e.price_period));if(e.action.includes("trend_line")){await D(),i==null||i.del_price_line(["parallelStraightLine_self"]);const n=e.times.split(","),_=e.prices.split(",").map((k,y)=>{const o=Number(k);return{timestamp:Number(n[y])||0,value:o||0}});i==null||i.createTag("straightLine","#00FF00",!0,_)}}}return(n,t)=>{const _=P,k=$,y=N;return d(),p(g,null,[s("div",H,[s("p",{style:u({color:l(r).color})},"执行账号:",4),a(k,{modelValue:e.api_key,"onUpdate:modelValue":t[0]||(t[0]=o=>e.api_key=o),placeholder:"选择执行的动作",teleported:!1,style:{width:"200px"},disabled:""},{default:c(()=>[(d(!0),p(g,null,F(l(r).bot_data.api_list,o=>(d(),b(_,{key:o.account_name,label:o.account_name,value:o.api_key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",J,[s("p",{style:u({color:l(r).color})},"执行币种:",4),a(l(w),{style:{width:"200px"},modelValue:e.symbol,"onUpdate:modelValue":t[1]||(t[1]=o=>e.symbol=o),disabled:""},null,8,["modelValue"])]),s("div",q,[s("p",{style:u({color:l(r).color})},"行情周期:",4),a(k,{modelValue:e.price_period,"onUpdate:modelValue":t[2]||(t[2]=o=>e.price_period=o),placeholder:"选择监控项目",teleported:!1,filterable:"",style:{width:"200px"}},{default:c(()=>[(d(!0),p(g,null,F(l(i).AllPeriods,o=>(d(),b(_,{key:o.timeframe,label:o.timeframe,value:o.timeframe},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",Q,[s("p",{style:u({color:l(r).color})},"锁仓类型:",4),a(k,{modelValue:e.action,"onUpdate:modelValue":t[3]||(t[3]=o=>e.action=o),placeholder:"选择执行的动作",teleported:!1,style:{width:"200px"}},{default:c(()=>[(d(!0),p(g,null,F(l(r).locks,o=>(d(),b(_,{key:o.action,label:o.action,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),e.action=="mix_lock"?(d(),p("div",W,[s("p",{style:u({color:l(r).color})},"执行模式:",4),a(l(x),{size:"default",modelValue:e.order_type,"onUpdate:modelValue":t[4]||(t[4]=o=>e.order_type=o)},{default:c(()=>[a(l(V),{value:"market"},{default:c(()=>[f("市价执行")]),_:1}),a(l(V),{value:"limit"},{default:c(()=>[f("限价执行")]),_:1})]),_:1},8,["modelValue"])])):m("",!0),e.action==="mix_lock"?(d(),p("div",X,[s("p",{style:u({color:l(r).color})},"百分占比:",4),a(l(w),{modelValue:e.ratio,"onUpdate:modelValue":t[5]||(t[5]=o=>e.ratio=o),placement:"left",style:{width:"180px"},step:.1,min:.1,max:100},null,8,["modelValue"]),s("p",{style:u({color:l(r).color})},"%",4)])):m("",!0),e.action==="mix_lock"?(d(),p("div",Y,[s("p",{style:u({color:l(r).color})},"加仓逻辑:",4),a(l(x),{size:"default",modelValue:e.mix_type,"onUpdate:modelValue":t[6]||(t[6]=o=>e.mix_type=o)},{default:c(()=>[a(l(V),{value:"average"},{default:c(()=>[f("一倍")]),_:1}),a(l(V),{value:"double"},{default:c(()=>[f("两倍")]),_:1}),a(l(V),{value:"three"},{default:c(()=>[f("三倍")]),_:1})]),_:1},8,["modelValue"])])):m("",!0),e.action==="mix_lock"?(d(),p("div",Z,[s("p",{style:u({color:l(r).color})},"执行次数:",4),a(l(w),{modelValue:e.order_num,"onUpdate:modelValue":t[7]||(t[7]=o=>e.order_num=o),placement:"left",style:{width:"200px"},step:1,min:1,max:15},null,8,["modelValue"])])):m("",!0),e.order_type==="limit"&&(e.action==="normal_lock"||e.action==="mix_lock")?(d(),p("div",ee,[s("p",{style:u({color:l(r).color})},"执行价格:",4),a(l(w),{modelValue:e.price,"onUpdate:modelValue":t[8]||(t[8]=o=>e.price=o),placeholder:"",style:{width:"200px"}},null,8,["modelValue"])])):m("",!0),e.action==="mix_lock"?(d(),p("div",oe,[s("p",{style:u({color:l(r).color})},"结束价格:",4),a(l(w),{modelValue:e.end_price,"onUpdate:modelValue":t[9]||(t[9]=o=>e.end_price=o),style:{width:"200px"}},null,8,["modelValue"])])):m("",!0),e.action==="ema_lock"||e.action==="trend_line_lock"?(d(),p("div",te,[s("p",{style:u({color:l(r).color})},"执行模式:",4),a(l(x),{size:"default",modelValue:e.order_type,"onUpdate:modelValue":t[10]||(t[10]=o=>e.order_type=o)},{default:c(()=>[a(l(V),{value:"market"},{default:c(()=>[f("收线执行")]),_:1}),a(l(V),{value:"limit"},{default:c(()=>[f("触碰执行")]),_:1})]),_:1},8,["modelValue"])])):m("",!0),e.action==="ema_lock"||e.action==="trend_line_lock"?(d(),p("div",le,[e.action==="trend_line_lock"?(d(),p("div",ie,[s("p",{style:u({color:l(r).color})},"画趋势线:",4),a(l(w),{modelValue:e.times,"onUpdate:modelValue":t[12]||(t[12]=o=>e.times=o),placeholder:"请画一条趋势线",style:{width:"200px"},disabled:""},M({_:2},[l(i).draw==="chart"?{name:"append",fn:c(()=>[a(y,{icon:l(L),onClick:t[11]||(t[11]=o=>C("straightLine"))},null,8,["icon"])]),key:"0"}:void 0]),1032,["modelValue"])])):m("",!0),e.action==="ema_lock"?(d(),p("div",ae,[s("p",{style:u({color:l(r).color})},"执行均线:",4),a(l(w),{modelValue:e.signal_period,"onUpdate:modelValue":t[13]||(t[13]=o=>e.signal_period=o),placeholder:"请输入执行均线",style:{width:"200px"}},null,8,["modelValue"])])):m("",!0)])):m("",!0),s("div",re,[a(y,{type:"primary",onClick:t[14]||(t[14]=o=>I())},{default:c(()=>[f("查看计划")]),_:1}),a(y,{type:"warning",onClick:t[15]||(t[15]=o=>h("del"))},{default:c(()=>[f("删除计划")]),_:1}),e.action==="trend_line_lock"?(d(),b(y,{key:0,type:"primary",onClick:t[16]||(t[16]=o=>h("edit"))},{default:c(()=>[f("修改计划")]),_:1})):m("",!0)])],64)}}});export{we as default};
