import{B as x,z as B,E as y}from"./zixuan_list.vue_vue_type_style_index_0_lang-Bztu2ySh.js";/* empty css                  */import{d as E,u as C,a as I,I as N,c as V,j as z,k as a,v as g,l as d,m as l,p as m,a0 as u,J as P}from"./main-BeSCBoN1.js";import{s as L}from"./SendData-B_I2FNqn.js";import{E as w}from"./index-CSTuB7SG.js";import"./index-DyY66E7G.js";const $={class:"container"},j={class:"center-container"},U=E({__name:"reduce_postion_item",props:{info:{},status:{default:"defaultStatus"}},setup(b){const o=C(),c=I(),f=b,t=N({});function k(){if(!f.info){console.warn("props.info is undefined or null, initializing with default empty swap_traderParams");return}try{Object.assign(t,f.info),t.action="reduce_position"}catch(i){console.error("Failed to initialize swap_trade_info:",i),w({title:"初始化失败",message:"执行账号信息初始化时出现错误，请检查输入数据。",type:"error"})}}k();async function v(i){return await y.confirm(i,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}function S(i){y.alert(i)}async function _(i){const e=localStorage.getItem("bot_ip"),r=localStorage.getItem("bot_key");if(!e||!r){console.warn("bot_ip 或 bot_key 未找到");return}const s=`http://${e}/takeover_order`,p={tradtype:"swap",symbol:t.symbol,action:"reduce_position",action_info:{item:t,action:i,symbol:t.symbol,side:t.side},key:r,account:t.api_key,side:t.side};try{const n=await L(p,s);n.status==="sucess"?(w({title:"执行成功",message:n.msg,type:"success"}),c.reset_swap_info(),o.del_all_price_tool()):await v(n.msg)}catch(n){console.error("请求错误:",n),S("请求出现错误，请重试")}}async function T(){return new Promise(i=>{const e=()=>{o.loadingkline?(console.log("loadingkline is true"),setTimeout(e,100)):i()};e()})}async function h(){if(o.chart){if(o.symbol.ticker!==t.symbol){const i=o.all_symbols.find(e=>e.ticker===t.symbol);if(i){const e=o.makePeriod(t.price_period);Object.assign(o.period,e),o.set_symbol(i)}}else o.period.timeframe!==t.price_period&&o.set_period(o.makePeriod(t.price_period));if(t.action.includes("trend_line")){await T(),o==null||o.del_price_line(["parallelStraightLine_self"]);const i=t.times.split(","),r=t.prices.split(",").map((s,p)=>{const n=Number(s);return{timestamp:Number(i[p])||0,value:n||0}});o==null||o.createTag("parallelStraightLine_self",void 0,!0,r)}}}return(i,e)=>{const r=B;return V(),z(P,null,[a("div",$,[a("p",{style:g({color:d(c).color})},"循环离场:",4),l(d(x),{modelValue:t.profit_ratio,"onUpdate:modelValue":e[0]||(e[0]=s=>t.profit_ratio=s),style:{width:"100px"}},null,8,["modelValue"]),a("p",{style:g({color:d(c).color})},"%-百倍利润",4)]),a("div",j,[l(r,{type:"primary",onClick:e[1]||(e[1]=s=>h())},{default:m(()=>[u("查看计划")]),_:1}),l(r,{type:"warning",onClick:e[2]||(e[2]=s=>_("del"))},{default:m(()=>[u("删除计划")]),_:1}),l(r,{type:"primary",onClick:e[3]||(e[3]=s=>_("edit"))},{default:m(()=>[u("修改计划")]),_:1})])],64)}}});export{U as default};
