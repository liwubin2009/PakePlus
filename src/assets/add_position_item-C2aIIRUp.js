import{D as k,G as D,H as L,B as v,z as U,E as V}from"./zixuan_list.vue_vue_type_style_index_0_lang-Bztu2ySh.js";/* empty css                  *//* empty css                 *//* empty css                        *//* empty css                  */import{a as P,E as $}from"./el-option-DgYD06Jd.js";/* empty css                  */import{d as j,u as A,a as K,I as O,w as G,c as f,j as g,k as r,v as u,l as n,m as c,p,J as F,a1 as M,e as E,a0 as y,E as R,s as h}from"./main-BeSCBoN1.js";import{s as H}from"./SendData-B_I2FNqn.js";import{E as x}from"./index-CSTuB7SG.js";import{E as J}from"./index-DGrJy6ZA.js";import"./index-DyY66E7G.js";const q={class:"container"},Q={class:"container"},W={key:0},X={class:"container"},Y={class:"container"},Z={class:"container"},ee={class:"container"},te={class:"center-container"},_e=j({__name:"add_position_item",props:{info:{},status:{default:"defaultStatus"}},setup(S){const o=A(),l=K(),w=S,e=O({});function T(){if(!w.info){console.warn("props.info is undefined or null, initializing with default empty swap_traderParams");return}console.log("Initializing swap_trade_info with props:",w.info);try{Object.assign(e,w.info),e.action=w.info.action}catch(i){console.error("Failed to initialize swap_trade_info:",i),x({title:"初始化失败",message:"执行账号信息初始化时出现错误，请检查输入数据。",type:"error"})}}T();async function B(i){return await V.confirm(i,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}function z(i){V.alert(i)}async function b(i){const t=localStorage.getItem("bot_ip"),d=localStorage.getItem("bot_key");if(!t||!d){console.warn("bot_ip 或 bot_key 未找到");return}const _=`http://${t}/takeover_order`,m={tradtype:"swap",symbol:e.symbol,action:"add_position",action_info:{item:e,action:i,symbol:e.symbol,side:e.side},key:d,account:e.api_key,side:e.side};try{const a=await H(m,_);a.status==="sucess"?(x({title:"执行成功",message:a.msg,type:"success"}),l.reset_swap_info(),o.del_all_price_tool()):await B(a.msg)}catch(a){console.error("请求错误:",a),z("请求出现错误，请重试")}}G(()=>l.swap_trade_info.prices,i=>{e.prices=l.swap_trade_info.prices,e.times=l.swap_trade_info.times});function C(i){l.swap_trade_info.times=e.times,l.swap_trade_info.prices=e.prices;const d=new Map([["entry_price","#00FF00"],["loss_price","#FF0000"],["end_price","#D9D919"],["win_price","#00FF00"],["active_price","#00FF00"],["monitor_loss_price","#FF0000"],["safe_price","#D9D919"],["monitor_win_price","#00FF00"],["straightLine","#00FF00"]]).get(i);o==null||o.del_price_line([i]),o==null||o.createTag(i,d)}async function I(){return new Promise(i=>{const t=()=>{o.loadingkline?(console.log("loadingkline is true"),setTimeout(t,100)):i()};t()})}async function N(){if(o.chart){if(o.symbol.ticker!==e.symbol){const i=o.all_symbols.find(t=>t.ticker===e.symbol);if(i){const t=o.makePeriod(e.price_period);Object.assign(o.period,t),o.set_symbol(i)}}else o.period.timeframe!==e.price_period&&o.set_period(o.makePeriod(e.price_period));if(e.action.includes("trend_line")){await I(),o==null||o.del_price_line(["parallelStraightLine_self"]);const i=e.times.split(","),d=e.prices.split(",").map((_,m)=>{const a=Number(_);return{timestamp:Number(i[m])||0,value:a||0}});o==null||o.createTag("parallelStraightLine_self","#00FF00",!0,d)}}}return(i,t)=>{const d=P,_=$,m=J,a=U;return f(),g(F,null,[r("div",q,[r("p",{style:u({color:n(l).color})},"加仓动作:",4),c(_,{modelValue:e.action,"onUpdate:modelValue":t[0]||(t[0]=s=>e.action=s),placeholder:"选择执行的动作",teleported:!1,style:{width:"200px"}},{default:p(()=>[(f(!0),g(F,null,M(n(l).add_postion_action_list,s=>(f(),E(d,{key:s.action,label:s.action,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),r("div",Q,[r("p",{style:u({color:n(l).color})},"加仓张数:",4),c(m,{modelValue:e.sz,"onUpdate:modelValue":t[1]||(t[1]=s=>e.sz=s),style:{width:"180px"},step:.1,min:.1},null,8,["modelValue"]),r("p",{style:u({color:n(l).color})},"张",4)]),e.action==="trend_line_add"?(f(),g("div",W,[r("div",X,[r("p",{style:u({color:n(l).color})},"执行模式:",4),c(n(D),{size:"default",modelValue:e.order_type,"onUpdate:modelValue":t[2]||(t[2]=s=>e.order_type=s)},{default:p(()=>[c(n(k),{value:"market"},{default:p(()=>[y("收线执行")]),_:1}),c(n(k),{value:"limit"},{default:p(()=>[y("触碰执行")]),_:1})]),_:1},8,["modelValue"])]),r("div",Y,[r("p",{style:u({color:n(l).color})},"画趋势线:",4),c(n(v),{modelValue:e.times,"onUpdate:modelValue":t[4]||(t[4]=s=>e.times=s),placeholder:"请画一条趋势线",style:{width:"200px"},disabled:""},R({_:2},[n(o).draw==="chart"?{name:"append",fn:p(()=>[c(a,{icon:n(L),onClick:t[3]||(t[3]=s=>C("parallelStraightLine_self"))},null,8,["icon"])]),key:"0"}:void 0]),1032,["modelValue"])]),r("div",Z,[r("p",{style:u({color:n(l).color})},"止损空间:",4),c(n(v),{modelValue:e.loss_present,"onUpdate:modelValue":t[5]||(t[5]=s=>e.loss_present=s),step:.1,min:0,style:{width:"200px"},disabled:""},null,8,["modelValue"])]),r("div",ee,[r("p",{style:u({color:n(l).color})},"盈亏比例:",4),c(m,{modelValue:e.win_multiple,"onUpdate:modelValue":t[6]||(t[6]=s=>e.win_multiple=s),step:.1,min:.1,style:{width:"200px"}},null,8,["modelValue"])])])):h("",!0),r("div",te,[c(a,{type:"primary",onClick:t[7]||(t[7]=s=>N())},{default:p(()=>[y("查看计划")]),_:1}),c(a,{type:"warning",onClick:t[8]||(t[8]=s=>b("del"))},{default:p(()=>[y("删除计划")]),_:1}),e.action==="trend_line_add"?(f(),E(a,{key:0,type:"primary",onClick:t[9]||(t[9]=s=>b("edit"))},{default:p(()=>[y("修改计划")]),_:1})):h("",!0)])],64)}}});export{_e as default};
