const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/signal-Co9VchBj.js","assets/zixuan_list.vue_vue_type_style_index_0_lang-Bztu2ySh.js","assets/main-BeSCBoN1.js","assets/index-DyY66E7G.js","assets/main-DMYBf86n.css","assets/zixuan_list-BvC8bdZc.css","assets/el-option-DgYD06Jd.js","assets/index-CSTuB7SG.js","assets/el-option-BHqzF8z9.css","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/signal-BenmxPEm.css","assets/trend_line-Dy6odjo2.js","assets/trend_line-CFgWg3qa.css","assets/el-button-CbVV1OIM.css","assets/open_action-D7EUMwbG.js","assets/index-DGrJy6ZA.js","assets/open_action-BaDwr47n.css","assets/mos_open-DLYx-cS-.js","assets/mos_open-Bi49F7rc.css"])))=>i.map(i=>d[i]);
import{_ as S}from"./index-DyY66E7G.js";import{D as g,G as x,z as H,E as N}from"./zixuan_list.vue_vue_type_style_index_0_lang-Bztu2ySh.js";/* empty css                  */import{E as w,a as Q}from"./el-option-DgYD06Jd.js";import{d as X,u as Y,a as Z,x as D,c as a,j as _,k as f,v,l as t,m as c,p as m,a0 as y,s as p,J as P,a1 as C,e as b,as as T}from"./main-BeSCBoN1.js";import{p as ee,a as oe}from"./post_browser-CYSuer52.js";import{E as te}from"./index-CSTuB7SG.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ie={key:0,class:"container"},se={class:"container"},re={key:1,class:"container"},le={key:2},ae={class:"container"},ce={class:"container"},me={key:7,class:"center-container"},ue=X({__name:"monitor_action",props:{info:{},status:{default:"defaultStatus"}},setup(L){const s=Y(),U=T(()=>S(()=>import("./signal-Co9VchBj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),$=T(()=>S(()=>import("./trend_line-Dy6odjo2.js"),__vite__mapDeps([11,1,2,3,4,5,9,12,13]))),R=T(()=>S(()=>import("./open_action-D7EUMwbG.js"),__vite__mapDeps([14,1,2,3,4,5,6,7,8,15,9,16,13]))),j=T(()=>S(()=>import("./mos_open-DLYx-cS-.js"),__vite__mapDeps([17,1,2,3,4,5,9,18,13]))),n=Z();D("");const E=D([]);async function h(i){return await N.confirm(i,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}function K(){const i=n.bot_data.api_list;return i?i.find(r=>r.ismaster==="sub")?!0:(n.monitor_info.account_switch="master",!1):!1}function z(i){N.alert(i)}const k=L,M=["win_multiple","lever","risk","endkbar","ema_period","first_ratio","order_num"],F=i=>{const e={},r=Object.keys(n.monitor_info);for(const l in i){const o=i[l];M.includes(l)&&typeof o!="number"&&r.includes(l)?e[l]=Number(o):e[l]=o}return e},W=i=>{if(!i||typeof i!="object")throw new Error("输入必须是一个对象");const e={};for(const[r,l]of Object.entries(i))l!=null&&l!==""&&(e[r]=l);return e};if(k.info){const i=W(k.info),e=F(i);n.monitor_info={...e,action:e.signal_type},n.monitor_data_symbol=e.symbol}else n.resetMonitor_info();async function G(){return new Promise(i=>{const e=()=>{s.loadingkline?(console.log("loadingkline is true"),setTimeout(e,100)):i()};e()})}async function J(i){if(s.chart){if(s.symbol.ticker!==i.symbol){const e=i.trade_type==="SWAP"?s.all_symbols.find(r=>r.ticker===i.symbol):s.spot_list.find(r=>r.ticker===i.symbol);if(e){const r=s.makePeriod(i.price_period);Object.assign(s.period,r),s.set_symbol(e)}}else s.period.timeframe!==i.price_period&&s.set_period(s.makePeriod(i.price_period));if(i.signal_type.includes("trend_line")){await G(),s==null||s.del_price_line(["parallelStraightLine_self"]);const e=i.times.split(","),l=i.prices.split(",").map((o,u)=>{const V=Number(o);return{timestamp:Number(e[u])||0,value:V||0}});s==null||s.createTag("parallelStraightLine_self",void 0,!0,l)}}}const I=async(i,e)=>{const r=localStorage.getItem("bot_ip"),l=localStorage.getItem("bot_key"),o=localStorage.getItem("mode"),u="http://"+r+"/takeover_order",V={...W(n.monitor_info),action_status:e},A={symbol:i.symbol,action:"monitor_item",key:l,action_info:V};if(await h("确认删除监控内容吗？"))try{let d;if(o==="no"?d=await new Promise(B=>{ee(A,u,function(q){B(q.data)})}):d=await oe(A,u),console.log("返回结果",d),d.status==="sucess")setTimeout(function(){te({title:"执行成功",message:d.msg,type:"success"})},1e3);else{const B=await h(d.msg)}}catch(d){z("请求出现错误，请重试"),console.error(d)}};function O(i){if(i!=="SWAP"&&i!=="SPOT")throw new Error('Invalid mode. Must be either "SWAP" or "SPOT".');const e=n.monitor_info.symbol||"BTC-USDT-SWAP",r=e.endsWith("SWAP");if(i==="SPOT"&&r){const l=s.spot_list.find(o=>o.ticker===e.replace(/-SWAP$/,""))||s.spot_list.find(o=>o.shortName==="BTC-USDT");E.value=s.spot_list,n.monitor_info.side!=="net"&&(n.monitor_info.side="net"),s.set_symbol(l)}else if(i==="SWAP"&&!r){const l=e.endsWith("-SWAP")?e:e.concat("-SWAP"),o=s.all_symbols.find(u=>u.ticker===l)||s.spot_list.find(u=>u.shortName==="BTC-USDT-SWAP");E.value=s.all_symbols,n.monitor_info.side=="net"&&(n.monitor_info.side=""),s.set_symbol(o)}}return(i,e)=>{const r=Q,l=H;return a(),_(P,null,[K()?(a(),_("div",ie,[f("p",{style:v({color:t(n).color})},"账号选择:",4),c(t(x),{size:"default",modelValue:t(n).monitor_info.account_switch,"onUpdate:modelValue":e[0]||(e[0]=o=>t(n).monitor_info.account_switch=o)},{default:m(()=>[c(t(g),{value:"master"},{default:m(()=>[y("主交易账户")]),_:1}),c(t(g),{value:"sub"},{default:m(()=>[y("副交易账户")]),_:1})]),_:1},8,["modelValue"])])):p("",!0),f("div",se,[f("p",{style:v({color:t(n).color})},"盯盘类型:",4),c(t(w),{modelValue:t(n).monitor_info.action,"onUpdate:modelValue":e[1]||(e[1]=o=>t(n).monitor_info.action=o),placeholder:"选择监控项目",teleported:!1,class:"select"},{default:m(()=>[(a(!0),_(P,null,C(t(n).monitoractions,o=>(a(),b(r,{key:o.action,label:o.action,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),t(n).monitor_info.action!=="monitor"?(a(),_("div",re,[f("p",{style:v({color:t(n).color})},"交易类型:",4),c(t(x),{size:"default",modelValue:t(n).monitor_info.trade_type,"onUpdate:modelValue":e[4]||(e[4]=o=>t(n).monitor_info.trade_type=o)},{default:m(()=>[c(t(g),{value:"SWAP",onClick:e[2]||(e[2]=o=>O("SWAP"))},{default:m(()=>[y("合约计划")]),_:1}),c(t(g),{value:"SPOT",onClick:e[3]||(e[3]=o=>O("SPOT"))},{default:m(()=>[y("现货计划")]),_:1})]),_:1},8,["modelValue"])])):p("",!0),t(n).monitor_info.action!=="monitor"?(a(),_("div",le,[f("div",ae,[f("p",{style:v({color:t(n).color})},"操作种类:",4),c(t(w),{modelValue:t(n).monitor_info.symbol,"onUpdate:modelValue":e[5]||(e[5]=o=>t(n).monitor_info.symbol=o),placeholder:"请选择币种",teleported:!1,style:{width:"200px"},filterable:""},{default:m(()=>[(a(!0),_(P,null,C(E.value,o=>(a(),b(r,{key:o.ticker,label:o.shortName,value:o.ticker,onClick:u=>t(s).set_symbol(o)},null,8,["label","value","onClick"]))),128))]),_:1},8,["modelValue"])]),f("div",ce,[f("p",{style:v({color:t(n).color})},"监控周期:",4),c(t(w),{modelValue:t(n).monitor_info.price_period,"onUpdate:modelValue":e[6]||(e[6]=o=>t(n).monitor_info.price_period=o),placeholder:"选择监控项目",teleported:!1,filterable:"",style:{width:"200px"}},{default:m(()=>[(a(!0),_(P,null,C(t(s).AllPeriods,o=>(a(),b(r,{key:o.timeframe,label:o.timeframe,value:o.timeframe,onClick:u=>t(s).set_period(o)},null,8,["label","value","onClick"]))),128))]),_:1},8,["modelValue"])])])):p("",!0),t(n).monitor_info.action==="monitor"?(a(),b(t(U),{key:3})):p("",!0),t(n).monitor_info.action==="trend_line_break"||t(n).monitor_info.action==="trend_line_support"||t(n).monitor_info.action==="ema_support"||t(n).monitor_info.action==="ema_break"?(a(),b(t($),{key:4})):p("",!0),t(n).monitor_info.action==="mos_open"?(a(),b(t(j),{key:5})):p("",!0),t(n).monitor_info.action!=="monitor"?(a(),b(t(R),{key:6})):p("",!0),k.status==="edit"?(a(),_("div",me,[c(l,{type:"primary",onClick:e[7]||(e[7]=o=>J(k.info))},{default:m(()=>[y("查看计划")]),_:1}),c(l,{type:"danger",onClick:e[8]||(e[8]=o=>I(k.info,"del"))},{default:m(()=>[y("删除计划")]),_:1}),c(l,{type:"success",onClick:e[9]||(e[9]=o=>I(k.info,"edit"))},{default:m(()=>[y("修改计划")]),_:1})])):p("",!0)],64)}}}),ge=ne(ue,[["__scopeId","data-v-9ad6e76f"]]);export{ge as default};
